---
import Layout from '../../layouts/Layout.astro';
import ContactSection from '../../components/sections/ContactSection.astro';
import ServicesPage from '../../components/pages/ServicesPage.astro';
import { defaultLocale, getMessages, locales, type Locale } from '../../i18n/config';
import { getAlternateLinks, buildLocaleUrl } from '../../i18n/utils';
import { servicesPageCopy } from '../../data/pages';

const locale: Locale = defaultLocale;
const messages = getMessages(locale);
const pageCopy = servicesPageCopy[locale];
const alternateLinks = getAlternateLinks(locale, Astro.url);

const languageSwitcher = {
  current: locale,
  options: locales.map((lang) => ({
    label: lang.toUpperCase(),
    value: lang,
    href: buildLocaleUrl(lang, Astro.url),
  })),
};

const faqStructuredData = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: pageCopy.faq.map((item) => ({
    '@type': 'Question',
    name: item.question,
    acceptedAnswer: {
      '@type': 'Answer',
      text: item.answer,
    },
  })),
};
---

<Layout
  locale={locale}
  messages={messages}
  alternateLinks={alternateLinks}
  languageSwitcher={languageSwitcher}
  pageMeta={pageCopy.meta}
  additionalStructuredData={[faqStructuredData]}
>
  <ServicesPage
    services={messages.services}
    contact={messages.contact}
    footerContact={messages.footer.contact}
    copy={pageCopy}
    successStoriesHref="/success-stories"
    contactHref="#contact"
  />
  <ContactSection contact={messages.contact} phoneNumber={messages.footer.contact.phone} />
</Layout>
